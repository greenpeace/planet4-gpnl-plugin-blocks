{"version":3,"sources":["gpnl-newsletter.js"],"names":["newsletter_form_element","getFormObj","el","formObj","inputs","$","serializeArray","each","i","input","name","value","prop","html","showErrorMessage","document","find","hide","append","window","location","href","on","post_form_value","action","nonce","form_config","marketingcode","literaturecode","screenid","id","toggleDisable","type","url","data","ajaxUrl","success","dataLayer","push","event","conv_campaign","conv_action","conv_label","console","log","forms","this","form","val","ajax","error","ajaxurl","response"],"mappings":"aAAA,IAAIA,wBAA0B,GA4D3B,SAFDC,WAAAC,GAGA,IAAAC,EAAA,GAGFC,EAAAC,EAAAH,GAAAI,iBAEEJ,OARAG,EAAEE,KAAKH,EAAQ,SAAUI,EAAGC,GAC1BN,EAAQM,EAAMC,MAAQD,EAAME,QAO9BR,EAKAE,SAAEL,cAAAA,GACFK,EAAEO,KAAA,YAAAV,EAAAU,KAA2BC,aAF/B,SAASC,iBAAiBd,GASxBe,EAAAA,GAAgBC,KAAW,KAAAC,OAC3BZ,EAAA,2BAAcQ,KAAA,WAEdR,EAAEE,iCAAsBM,KAAA,6CACtBR,EAAAL,GAAAkB,OACA,YAAWC,OAAIC,SAAYC,KAAA,uEAnF/BhB,EAAE,0BAA0BiB,GAAG,SAAU,WAIvC,IAAIC,EAAkBtB,WAJtBD,wBAA0BsB,MAItBC,EAAAA,0BAA6BvB,EAAjC,QAGAuB,EAAgBC,OAAS,0BACzBD,EAAgBE,MAASN,OAAOO,GAAaD,MAC7CF,EAAgBI,cAAiBR,OAAOO,GAAaC,cACrDJ,EAAgBK,eAAkBT,OAAOO,GAAaE,eACtDL,EAAgBM,SAAYV,OAAOO,GAAaG,SAChDN,EAAgBO,GAAMX,OAAOO,GAAaI,GAI1CC,cAAIR,EAAAA,yBAA8BP,KAAA,MACfhB,KAAjBc,EAAiBd,MAKjBgC,EAAAA,KAAI,CACJC,KAASd,OACTe,IAASX,OAAAA,GAHJY,QAILC,KAASb,EACPa,QAAA,WAEA/B,QAAEL,IAAAA,OACFK,EAAEL,yBAADgB,KAA4BH,KAAKI,OAClCZ,EAAE,2BAAAQ,KAAF,6BAAAR,EAAE,iCAAiCQ,KAAK,mFAKlB,oBAAlBwB,WACAA,UAAAC,KAAA,CACAC,MAAkB,uBAClBC,cAAkBjB,EAAAK,eAJpBa,YAAA,aAMDC,WAAA,4BAMDC,MAAAA,WAzBJA,QAAAC,IAAA,OAgCF9B,iBAAAd,4BAnCIc,iBAAAd,2BAqEEiC,EAAAA,UAASd,MAAO,WAChBe,IAAAA,EAAS7B,EAAA,0BAAAA,EAAAE,KAHJsC,EAAA,WAILT,IAAAA,EAASU,KAEP3B,EAAOO,0BADPrB,EAAA0C,GAAA/B,KAAA,oBAAAgC,MAED3C,EAAA4C,KAPI,CAQLC,KAAO,OACLjB,IAAAd,OAAA,QAAAgC,QACAjB,KAAA,CAAAV,OAAA,cACAmB,QAAO,SAAKS,GAEbjC,OAAAO,GAAAI,GAAAsB,EAAAlB,KAAAJ,IAjBLoB,MAAA,WAeMP,QAAQC,IAAI,OACZ9B,iBAAiBiC","file":"../gpnl-newsletter.js","sourcesContent":["var newsletter_form_element = {};\n$('.gpnl-newsletter__form').on('submit', function () {\n\n  newsletter_form_element = this;\n  // Get the  parameter from the newsletter form and add the action and CSRF protection\n  var post_form_value = getFormObj(newsletter_form_element);\n  var form_config = 'newsletter_form_object_' + post_form_value['form_id'];\n\n  post_form_value.action = 'newsletter_form_process';\n  post_form_value.nonce  = window[form_config].nonce;\n  post_form_value.marketingcode  = window[form_config].marketingcode;\n  post_form_value.literaturecode  = window[form_config].literaturecode;\n  post_form_value.screenid  = window[form_config].screenid;\n  post_form_value.id  = window[form_config].id;\n\n\n  toggleDisable($(newsletter_form_element).find('*'));\n  if (post_form_value.human !== '') {\n    showErrorMessage(newsletter_form_element);\n    return;\n  }\n\n  $.ajax({\n    type:    'POST',\n    url:     window[form_config].ajaxUrl,\n    data:    post_form_value,\n    success: function() {\n      // eslint-disable-next-line no-console\n      console.log('^-^');\n      $(newsletter_form_element).find('*').hide();\n      $('.gpnl-newsletter__title').html('Hoera, je bent er bijna! ');\n      $('.gpnl-newsletter__description').html('<h4>Bevestig je aanmelding via de mail die je van ons ontvangt. Bedankt!  </h4>');\n\n      // Send conversion event to the GTM\n      if (typeof dataLayer !== 'undefined') {\n        dataLayer.push({\n          'event'         : 'nieuwsbriefformulier',\n          'conv_campaign' : post_form_value.literaturecode,\n          'conv_action'   : 'registreer',\n          'conv_label'    : 'registreer-nieuwsbrief'\n        });\n      }\n\n    },\n    error: function(){\n      // If the backend sends an error, hide the thank element and show an error urging to try again\n      // eslint-disable-next-line no-console\n      console.log('o_o');\n      showErrorMessage(newsletter_form_element);\n    }\n  });\n\n});\n\n// Get the key+value from the input fields in the form\nfunction getFormObj(el) {\n  var formObj = {};\n  var inputs = $(el).serializeArray();\n  $.each(inputs, function (i, input) {\n    formObj[input.name] = input.value;\n  });\n  return formObj;\n}\n\n// Toggle the disabled state on form elements\nfunction toggleDisable(el) {\n  el.prop('disabled', !el.prop('disabled'));\n\n}\n\nfunction showErrorMessage(newsletter_form_element) {\n  $(newsletter_form_element).find('*').hide();\n  $('.gpnl-newsletter__title').html('Oh nee!');\n  $('.gpnl-newsletter__description').html('<p>Hier gaat helaas iets mis, sorry. </p>');\n  $(newsletter_form_element).append(\n    '<a href=\\''+window.location.href +'\\' class=\"btn btn-primary btn-block\"' +\n    '\">Probeer je het nog eens? </a>');\n}\n\n$(document).ready(function() {\n  let forms = $('.gpnl-newsletter__form');\n\n  $.each(forms, function(){\n    let form = this;\n    let form_id = $(form).find('[name=\"form_id\"]').val();\n    let form_config = 'newsletter_form_object_' + form_id;\n    $.ajax({\n      type:    'POST',\n      url:     window['p4_vars'].ajaxurl,\n      data:    {'action' : 'request_id'},\n      success: function(response) {\n        // eslint-disable-next-line no-console\n        window[form_config].id = response.data.id;\n      },\n      error: function(){\n        // If the backend sends an error, hide the thank element and show an error urging to try again\n        // eslint-disable-next-line no-console\n        console.log('o_o');\n        showErrorMessage(form);\n      }\n    });\n  });\n});\n"]}