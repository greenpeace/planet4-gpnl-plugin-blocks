{"version":3,"sources":["gpnl-newsletter.js"],"names":["newsletter_form_element","formObj","name","inputs","el","serializeArray","$","each","i","input","value","toggleDisable","showErrorMessage","find","hide","document","html","append","window","location","href","on","post_form_value","getFormObj","action","nonce","form_config","marketingcode","literaturecode","screenid","human","ajax","type","url","ajaxUrl","data","success","console","log","dataLayer","push","event","conv_campaign","conv_action","conv_label","error","ready","forms","form","this","val","ajaxurl","response"],"mappings":"aAAA,IAAIA,wBAA0B,GAyD1BC,SAAAA,WAAcC,GACf,IAFDD,EAAA,GAGAE,EAAOF,EAAPG,GAAAC,iBAIF,OADAC,EAAAC,KAAAJ,EAAA,SAAAK,EAAAC,GALIR,EAAQQ,EAAMP,MAAQO,EAAMC,QAMvBC,EAKT,SAASC,cAAAA,GACPN,EAAEN,KAAAA,YAAAA,EAAAA,KAAyBa,aAM5B,SAAAD,iBAAAZ,GANCM,EAAEN,GAAyBa,KAAK,KAAKC,OAQrCC,EAAAA,2BAA2BC,KAAA,WAC3BV,EAAA,iCAAcU,KAAd,6CAEAV,EAAEC,GAAsBU,OACtB,YAAWC,OAAXC,SAAAC,KAAA,uEAhFJd,EAAE,0BAA0Be,GAAG,SAAU,WAIvC,IAAIC,EAAkBC,WAJtBvB,wBAA0BqB,MAItBC,EAAAA,0BAA6BtB,EAAjC,QAGAsB,EAAgBE,OAAS,0BACzBF,EAAgBG,MAASP,OAAOQ,GAAaD,MAC7CH,EAAgBK,cAAiBT,OAAOQ,GAAaC,cACrDL,EAAgBM,eAAkBV,OAAOQ,GAAaE,eACtDN,EAAgBO,SAAYX,OAAOQ,GAAaG,SAEhDlB,cAAcL,EAAEN,yBAAyBa,KAAK,MAChB,KAA1BS,EAAgBQ,MAKpBxB,EAAEyB,KAAK,CACLC,KAAS,OACTC,IAASf,OAAOQ,GAAaQ,QAC7BC,KAASb,EACTc,QAAS,WAEPC,QAAQC,IAAI,OACZhC,EAAEN,yBAAyBa,KAAK,KAAKC,OACrCR,EAAE,2BAA2BU,KAAK,6BAClCV,EAAE,iCAAiCU,KAAK,mFAIvB,oBAANuB,WACPA,UAAAC,KAAkB,CAClBC,MAAkBnB,uBAClBoB,cAAkBpB,EAHLM,eAIbe,YAAkB,aAJpBC,WAAA,4BAWFC,MAAA,WAGDR,QAAAC,IAAA,OA3BH1B,iBAAAZ,4BAJEY,iBAAiBZ,2BAqEfgC,EAAAA,UAASc,MADJ,WAELb,IAAAA,EAASf,EAAAA,0BACCZ,EAAAC,KAAAwC,EAAA,WAAD,IAHJC,EAAAC,KAKHvB,EAAA,0BADOpB,EAAA0C,GAAAnC,KAAA,oBAAmBqC,MAE1BhC,EAAAA,KAAAA,CACDc,KAPI,OAQLa,IAAO3B,OAAA,QAAUiC,QACfhB,KAAA,CAAAX,OAAA,cACAY,QAAA,SAAAgB,GAEAxC,OAAAA,GAAiBoC,MAAjBI,EAAAjB,KAAAV,OAZJoB,MAAA,WAWIR,QAAQC,IAAI,OACZ1B,iBAAiBoC","file":"../gpnl-newsletter.js","sourcesContent":["var newsletter_form_element = {};\n$('.gpnl-newsletter__form').on('submit', function () {\n\n  newsletter_form_element = this;\n  // Get the  parameter from the newsletter form and add the action and CSRF protection\n  var post_form_value = getFormObj(newsletter_form_element);\n  var form_config = 'newsletter_form_object_' + post_form_value['form_id'];\n\n  post_form_value.action = 'newsletter_form_process';\n  post_form_value.nonce  = window[form_config].nonce;\n  post_form_value.marketingcode  = window[form_config].marketingcode;\n  post_form_value.literaturecode  = window[form_config].literaturecode;\n  post_form_value.screenid  = window[form_config].screenid;\n\n  toggleDisable($(newsletter_form_element).find('*'));\n  if (post_form_value.human !== '') {\n    showErrorMessage(newsletter_form_element);\n    return;\n  }\n\n  $.ajax({\n    type:    'POST',\n    url:     window[form_config].ajaxUrl,\n    data:    post_form_value,\n    success: function() {\n      // eslint-disable-next-line no-console\n      console.log('^-^');\n      $(newsletter_form_element).find('*').hide();\n      $('.gpnl-newsletter__title').html('Hoera, je bent er bijna! ');\n      $('.gpnl-newsletter__description').html('<h4>Bevestig je aanmelding via de mail die je van ons ontvangt. Bedankt!  </h4>');\n\n      // Send conversion event to the GTM\n      if (typeof dataLayer !== 'undefined') {\n        dataLayer.push({\n          'event'         : 'nieuwsbriefformulier',\n          'conv_campaign' : post_form_value.literaturecode,\n          'conv_action'   : 'registreer',\n          'conv_label'    : 'registreer-nieuwsbrief'\n        });\n      }\n\n    },\n    error: function(){\n      // If the backend sends an error, hide the thank element and show an error urging to try again\n      // eslint-disable-next-line no-console\n      console.log('o_o');\n      showErrorMessage(newsletter_form_element);\n    }\n  });\n\n});\n\n// Get the key+value from the input fields in the form\nfunction getFormObj(el) {\n  var formObj = {};\n  var inputs = $(el).serializeArray();\n  $.each(inputs, function (i, input) {\n    formObj[input.name] = input.value;\n  });\n  return formObj;\n}\n\n// Toggle the disabled state on form elements\nfunction toggleDisable(el) {\n  el.prop('disabled', !el.prop('disabled'));\n\n}\n\nfunction showErrorMessage(newsletter_form_element) {\n  $(newsletter_form_element).find('*').hide();\n  $('.gpnl-newsletter__title').html('Oh nee!');\n  $('.gpnl-newsletter__description').html('<p>Hier gaat helaas iets mis, sorry. </p>');\n  $(newsletter_form_element).append(\n    '<a href=\\''+window.location.href +'\\' class=\"btn btn-primary btn-block\"' +\n    '\">Probeer je het nog eens? </a>');\n}\n\n$(document).ready(function() {\n  let forms = $('.gpnl-newsletter__form');\n\n  $.each(forms, function(){\n    let form = this;\n    let form_id = $(form).find('[name=\"form_id\"]').val();\n    let form_config = 'newsletter_form_object_' + form_id;\n    $.ajax({\n      type:    'POST',\n      url:     window['p4_vars'].ajaxurl,\n      data:    {'action' : 'request_id'},\n      success: function(response) {\n        // eslint-disable-next-line no-console\n        window[form_config].nonce = response.data.nonce;\n      },\n      error: function(){\n        // If the backend sends an error, hide the thank element and show an error urging to try again\n        // eslint-disable-next-line no-console\n        console.log('o_o');\n        showErrorMessage(form);\n      }\n    });\n  });\n});\n"]}