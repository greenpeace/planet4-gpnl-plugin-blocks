{"version":3,"sources":["gpnl-inforequest.js"],"names":["request_form_element","check_form_element","formObj","name","inputs","el","serializeArray","$","each","i","input","value","append","find","hide","window","href","date","setTime","getTime","document","encodeURI","readCookie","days","nameEQ","ca","cookie","domain","toGMTString","charAt","c","substring","length","indexOf","cover","this","attr","form_config","ready","URLSearchParams","location","search","has","auth","nextAll","hider","after","html","show","on","btn","data","form","post_form_value","getFormObj","nonce","literaturecode","toggleDisable","showErrorMessage","type","url","ajaxUrl","success","prepend","createCookie","enableDownloadlinks","action","human","remove"],"mappings":"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","file":"../gpnl-inforequest.js","sourcesContent":["var request_form_element = {};\nvar check_form_element = {};\nvar form_config = 'request_form_object';\n\n$(document).ready(function() {\n  let auth = new URLSearchParams(window.location.search).has('e');\n  if ( '1' === window[form_config].hider ) {\n    $('.inforequest__wrapper').nextAll().hide();\n    $('.inforequest__title').html('<h3>Lesmateriaal downloaden</h3>');\n    $('.inforequest__title').after('<p class=\"inforequest__message\">Registreer of log in om het lesmateriaal te downloaden.</p>');\n  }\n  if (null !== readCookie('gpnl_education') || auth ){\n    $('.inforequest__title').html('<h3>Welkom terug!</h3>');\n    $('.inforequest__message').html('<p>Je kan nu gebruikmaken van de lesmaterialen.</p>');\n    $('.inforequest__wrapper').nextAll().show(1000);\n  }\n  else{\n    $('.hideshowbtn').show(1000);\n  }\n});\n\n$('.hideshowbtn').on('click', function () {\n  let btn = $(this);\n  let form  = btn.data('target');\n  $(form).show(1000);\n  $('.hideshowbtn').hide(1000);\n});\n\n$('.inforequest_form').on('reset', function () {\n  $(this).hide(1000);\n  $('.hideshowbtn').show(1000);\n});\n\n$('.gpnl-request__form').on('submit', function () {\n  request_form_element = this;\n  var post_form_value = getFormObj(request_form_element);\n  post_form_value.action = 'request_form_process';\n  post_form_value.nonce  = window[form_config].nonce;\n  post_form_value.literaturecode  = window[form_config].literaturecode;\n\n  toggleDisable($(request_form_element).find('*'));\n  if (post_form_value.human !== '') {\n    showErrorMessage(request_form_element);\n    return;\n  }\n\n  $.ajax({\n    type:    'POST',\n    url:     window[form_config].ajaxUrl,\n    data:    post_form_value,\n    success: function() {\n      $(request_form_element).find('*').hide(1000);\n      $('.inforequest__title').html('<h3>Dank je voor je aanmelding!</h3>');\n      $(request_form_element).prepend('<p>Je kan nu gebruikmaken van de lesmaterialen.</p>');\n      if (null !== readCookie('greenpeace')){\n        createCookie('gpnl_education', 1, 365);\n        if (window[form_config].hider === '1') {\n          $('.inforequest__wrapper').nextAll().show(1000);\n          $('.inforequest__message').hide(1000);\n\n        }\n      }\n      else{\n        enableDownloadlinks();\n      }\n\n    },\n    error: function(){\n      // If the backend sends an error, hide the thank element and show an error urging to try again\n      showErrorMessage(request_form_element);\n    }\n  });\n});\n\n$('.gpnl-check__form').on('submit', function () {\n  check_form_element = this;\n  var post_form_value = getFormObj(check_form_element);\n  post_form_value.action = 'check_form_process';\n  post_form_value.nonce  = window[form_config].nonce;\n\n  toggleDisable($(check_form_element).find('*'));\n  if (post_form_value.human !== '') {\n    showErrorMessage(check_form_element);\n    return;\n  }\n\n  $.ajax({\n    type:    'POST',\n    url:     window[form_config].ajaxUrl,\n    data:    post_form_value,\n    success: function() {\n      $(check_form_element).find('*').hide(1000);\n      $('.inforequest__title').html('<h3>Welkom terug!</h3>');\n      $(check_form_element).prepend('<p>Je kan nu gebruikmaken van de lesmaterialen.</p>');\n      if (null !== readCookie('greenpeace')){\n        createCookie('gpnl_education', 1, 365);\n        if (window[form_config].hider === '1') {\n          $('.inforequest__wrapper').nextAll().show(1000);\n          $('.inforequest__message').hide(1000);\n        }\n      }\n      else {\n        enableDownloadlinks();\n      }\n\n    },\n    error: function(){\n      // If the backend sends an error, hide the thank element and show an error urging to try again\n      $('.resetBtn').remove('*');\n      $('.gpnl-check__form').hide(1000);\n      $('.gpnl-request__form').prepend('<p>Dit emailadres is niet bij ons bekend. Wil je je inschrijven?');\n      $('.gpnl-request__form').show(1000);\n      $('.hideshowbtn').remove('*');\n    }\n  });\n});\n\n// Get the key+value from the input fields in the form\nfunction getFormObj(el) {\n  var formObj = {};\n  var inputs = $(el).serializeArray();\n  $.each(inputs, function (i, input) {\n    formObj[input.name] = input.value;\n  });\n  return formObj;\n}\n\nfunction showErrorMessage(request_form_element) {\n  $(request_form_element).find('*').hide();\n  $(request_form_element).append('Oh nee!');\n  $(request_form_element).append('<p>Hier gaat helaas iets mis, sorry. </p>');\n  $(request_form_element).append(\n    '<a href=\\''+window.location.href +'\\' class=\"btn btn-primary btn-block\"' +\n    '\">Probeer je het nog eens? </a>');\n}\n\n// Toggle the disabled state on form elements\nfunction toggleDisable(el) {\n  el.prop('disabled', !el.prop('disabled'));\n}\n\nfunction createCookie(name, value, days) {\n  var date = new Date();\n  date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n  document.cookie = encodeURI(name) + '=' + encodeURI(value) + ';domain=.' + document.domain + ';path=/;' + '; expires=' + date.toGMTString();\n}\n\nfunction readCookie(name) {\n  var nameEQ = name + '=';\n  var ca = document.cookie.split(';');\n  for (var i = 0; i < ca.length; i++) {\n    var c = ca[i];\n    while (c.charAt(0) === ' ') {\n      c = c.substring(1, c.length);\n    }\n    if (c.indexOf(nameEQ) === 0) {\n      return c.substring(nameEQ.length, c.length);\n    }\n  }\n  return null;\n}\n\nfunction enableDownloadlinks() {\n  $('.cover-card-column').each(function(){\n    let cover = this\n    $(cover).find('a').each(function(){\n      let link = this;\n      let href = $(this).attr('href');\n      $(link).attr('href', href + '?e=1');\n    });\n  });\n}\n"]}