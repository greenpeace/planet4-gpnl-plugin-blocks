{"version":3,"sources":["gpnl-inforequest.js"],"names":["request_form_element","check_form_element","getFormObj","el","formObj","inputs","$","serializeArray","each","i","input","showErrorMessage","find","hide","append","prop","window","location","href","document","encodeURI","nameEQ","name","value","days","ca","date","setTime","getTime","length","domain","toGMTString","readCookie","c","substring","cookie","split","indexOf","enableDownloadlinks","cover","this","attr","form_config","ready","URLSearchParams","search","has","auth","nextAll","hider","after","html","show","on","btn","classname","pop","form","data","post_form_value","literaturecode","toggleDisable","nonce","human","url","success","ajaxUrl","prepend","createCookie","error","remove","ajax"],"mappings":"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","file":"../gpnl-inforequest.js","sourcesContent":["var request_form_element = {};\nvar check_form_element = {};\nvar form_config = 'request_form_object';\n\n$(document).ready(function() {\n  let auth = new URLSearchParams(window.location.search).has('e');\n  if ( '1' === window[form_config].hider ) {\n    $('.inforequest__wrapper').nextAll().hide();\n    $('.inforequest__title').html('<h3>Lesmateriaal downloaden</h3>');\n    $('.inforequest__title').after('<p class=\"inforequest__message\">Registreer of log in om het lesmateriaal te downloaden.</p>');\n  }\n  if (null !== readCookie('gpnl_education') || auth ){\n    $('.inforequest__title').html('<h3>Welkom terug!</h3>');\n    $('.inforequest__message').html('<p>Je kan nu gebruikmaken van de lesmaterialen.</p>');\n    $('.inforequest__wrapper').nextAll().show(1000);\n    $('.fallbackbtn').show(1000);\n  }\n  else{\n    $('.hideshowbtn').show(1000);\n  }\n});\n\n\n$('.hideshowbtn, .fallbackbtn').on('click', function () {\n  let btn = $(this);\n  let classname = '.' + btn.attr('class').split(/\\s+/).pop();\n  let form  = btn.data('target');\n  $(form).show(1000);\n  $(classname).hide(1000);\n});\n\n$('.inforequest_form').on('reset', function () {\n  $(this).hide(1000);\n  $('.hideshowbtn').show(1000);\n});\n\n$('.gpnl-request__form').on('submit', function () {\n  request_form_element = this;\n  var post_form_value = getFormObj(request_form_element);\n  post_form_value.action = 'request_form_process';\n  post_form_value.nonce  = window[form_config].nonce;\n  post_form_value.literaturecode  = window[form_config].literaturecode;\n\n  toggleDisable($(request_form_element).find('*'));\n  if (post_form_value.human !== '') {\n    showErrorMessage(request_form_element);\n    return;\n  }\n\n  $.ajax({\n    type:    'POST',\n    url:     window[form_config].ajaxUrl,\n    data:    post_form_value,\n    success: function() {\n      $(request_form_element).find('*').hide(1000);\n      $('.inforequest__title').html('<h3>Dank je voor je aanmelding!</h3>');\n      $(request_form_element).prepend('<p>Je kan nu gebruikmaken van de lesmaterialen.</p>');\n      $('.fallbackbtn').show(1000);\n      if (null !== readCookie('greenpeace')){\n        createCookie('gpnl_education', 1, 365);\n        if (window[form_config].hider === '1') {\n          $('.inforequest__wrapper').nextAll().show(1000);\n          $('.inforequest__message').hide(1000);\n\n        }\n      }\n      else{\n        enableDownloadlinks();\n      }\n\n    },\n    error: function(){\n      // If the backend sends an error, hide the thank element and show an error urging to try again\n      showErrorMessage(request_form_element);\n    }\n  });\n});\n\n$('.gpnl-check__form').on('submit', function () {\n  check_form_element = this;\n  var post_form_value = getFormObj(check_form_element);\n  post_form_value.action = 'check_form_process';\n  post_form_value.nonce  = window[form_config].nonce;\n\n  toggleDisable($(check_form_element).find('*'));\n  if (post_form_value.human !== '') {\n    showErrorMessage(check_form_element);\n    return;\n  }\n\n  $.ajax({\n    type:    'POST',\n    url:     window[form_config].ajaxUrl,\n    data:    post_form_value,\n    success: function() {\n      $(check_form_element).find('*').hide(1000);\n      $('.inforequest__title').html('<h3>Welkom terug!</h3>');\n      $(check_form_element).prepend('<p>Je kan nu gebruikmaken van de lesmaterialen.</p>');\n      $('.fallbackbtn').show(1000);\n      if (null !== readCookie('greenpeace')){\n        createCookie('gpnl_education', 1, 365);\n        if (window[form_config].hider === '1') {\n          $('.inforequest__wrapper').nextAll().show(1000);\n          $('.inforequest__message').hide(1000);\n        }\n      }\n      else {\n        enableDownloadlinks();\n      }\n\n    },\n    error: function(){\n      // If the backend sends an error, hide the thank element and show an error urging to try again\n      $('.resetBtn').remove('*');\n      $('.gpnl-check__form').hide(1000);\n      $('.gpnl-request__form').prepend('<p>Dit emailadres is niet bij ons bekend. Wil je je inschrijven?');\n      $('.gpnl-request__form').show(1000);\n      $('.hideshowbtn').remove('*');\n    }\n  });\n});\n\n// Get the key+value from the input fields in the form\nfunction getFormObj(el) {\n  var formObj = {};\n  var inputs = $(el).serializeArray();\n  $.each(inputs, function (i, input) {\n    formObj[input.name] = input.value;\n  });\n  return formObj;\n}\n\nfunction showErrorMessage(request_form_element) {\n  $(request_form_element).find('*').hide();\n  $(request_form_element).append('Oh nee!');\n  $(request_form_element).append('<p>Hier gaat helaas iets mis, sorry. </p>');\n  $(request_form_element).append(\n    '<a href=\\''+window.location.href +'\\' class=\"btn btn-primary btn-block\"' +\n    '\">Probeer je het nog eens? </a>');\n}\n\n// Toggle the disabled state on form elements\nfunction toggleDisable(el) {\n  el.prop('disabled', !el.prop('disabled'));\n}\n\nfunction createCookie(name, value, days) {\n  var date = new Date();\n  date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n  document.cookie = encodeURI(name) + '=' + encodeURI(value) + ';domain=.' + document.domain + ';path=/;' + '; expires=' + date.toGMTString();\n}\n\nfunction readCookie(name) {\n  var nameEQ = name + '=';\n  var ca = document.cookie.split(';');\n  for (var i = 0; i < ca.length; i++) {\n    var c = ca[i];\n    while (c.charAt(0) === ' ') {\n      c = c.substring(1, c.length);\n    }\n    if (c.indexOf(nameEQ) === 0) {\n      return c.substring(nameEQ.length, c.length);\n    }\n  }\n  return null;\n}\n\nfunction enableDownloadlinks() {\n  $('.cover-card-column').each(function(){\n    let cover = this;\n    $(cover).find('a').each(function(){\n      let link = this;\n      let href = $(this).attr('href');\n      $(link).attr('href', href + '?e=1');\n    });\n  });\n}\n"]}