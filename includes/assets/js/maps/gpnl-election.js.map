{"version":3,"sources":["gpnl-election.js"],"names":["getFormObj","el","formObj","inputs","$","serializeArray","each","i","input","name","value","cardflip","prop","element","parent","nextElementSibling","css","parentNode","flip_positionattribute","find","toggle","card","off","toggleClass","one","form_config","analytics_campaign","fireShareEvent","platform","form_id","console","log","dataLayer","push","event","conv_campaign","window","conv_action","ga_action","conv_label","socialBlueDeDuplicate","email","phone","apref","apHost","append","unescape","location","protocol","apSrc","script","document","err","createElement","type","src","getUrlVars","appendChild","hash","vars","hashes","href","split","slice","indexOf","length","on","id","relatedTarget","data","button","this","modal","config","text","title","jQuery","infinite","slick","mobileFirst","slidesToShow","slidesToScroll","arrows","dots","centerMode","centerPadding","initialSlide","responsive","breakpoint","settings","petition_form_element","post_form_value","action","ad_campaign","nonce","toggleDisable","success","ajaxUrl","fbq","jalt_track","undefined","clang","conversion","track","error","cardback","hide"],"mappings":"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","file":"../gpnl-election.js","sourcesContent":["$('#electionModal').on('show.bs.modal', function (event) {\n  var button = $(event.relatedTarget);\n  var id = button.data('id');\n  var modal = $(this);\n  var config = 'election_object_' + id;\n\n  modal.find('.modal-title').text('Stem op ' + window[config].title);\n  modal.find('.modal-subtitle').text(window[config].subtitle);\n  modal.find('.modal-body').text( window[config].description );\n});\n\njQuery(function ($) {\n\n  // convert an element to slider using slick js\n  function slickify(element) {\n    $(element).slick({\n      infinite:       false,\n      mobileFirst:    true,\n      slidesToShow:   1,\n      slidesToScroll: 1,\n      arrows:         true,\n      dots:           true,\n      centerMode:     true,\n      centerPadding:  '20px',\n      initialSlide:   3,\n      responsive: [\n        {\n          breakpoint: 992,\n          settings: { slidesToShow: 5 }\n        },\n        {\n          breakpoint: 768,\n          settings: { slidesToShow: 3 }\n        },\n        {\n          breakpoint: 576,\n          settings: { slidesToShow: 2 }\n        }\n      ]\n    });\n  }\n\n  slickify('.election-options');\n\n});\n\n$('.gpnl-petitionform').on('submit', function () {\n  var petition_form_element = this;\n  console.log(petition_form_element);\n  // Get the  parameter from the petition form and add the action and CSRF protection\n  var post_form_value = getFormObj(petition_form_element);\n  var form_config = 'petition_form_object_' + post_form_value['form_id'];\n\n  post_form_value.action = 'petition_form_process';\n  post_form_value.nonce  = window[form_config].nonce;\n  post_form_value.ad_campaign = window[form_config].ad_campaign;\n\n  // Disable the form so people can't resubmit\n  toggleDisable($(petition_form_element).find('*'));\n\n  // Do a ajax call to the wp_admin admin_ajax.php,\n  // which triggers processing function in the petition block\n  $.ajax({\n    type:    'POST',\n    url:     window[form_config].ajaxUrl,\n    data:    post_form_value,\n    success: function(data) {\n      // eslint-disable-next-line no-console\n      console.log('^-^');\n      console.log(petition_form_element);\n\n      // Send conversion event to the GTM\n      if (typeof dataLayer !== 'undefined') {\n        dataLayer.push({\n          'event'         :'petitiebutton',\n          'conv_campaign' : window[form_config].analytics_campaign,\n          'conv_action'   : window[form_config].ga_action,\n          'conv_label'    :'registreer'\n        });\n      }\n\n      // if consent was given by entering phonenumber\n      if (post_form_value.phone !== '') {\n        // Send conversion event to the GTM\n        if (typeof dataLayer !== 'undefined') {\n          dataLayer.push({\n            'event'         :'petitiebutton',\n            'conv_campaign' : window[form_config].analytics_campaign,\n            'conv_action'   :'telnr',\n            'conv_label'    :'Ja'\n          });\n        }\n        // If an ad campaign is run by an external company fire the conversiontracking\n        if (window[form_config].ad_campaign === 'SB') {\n          fbq('track', 'Lead');\n          // if it is run by social blue, also deduplicate\n          socialBlueDeDuplicate(post_form_value['mail'], data['data']['phone'], window[form_config].apref);\n        } else if (window[form_config].ad_campaign === 'JA') {\n          fbq('track', window[form_config].jalt_track);\n        }\n      }\n      else{\n        if (typeof dataLayer !== 'undefined') {\n          dataLayer.push({\n            'event'         :'petitiebutton',\n            'conv_campaign' : window[form_config].analytics_campaign,\n            'conv_action'   :'telnr',\n            'conv_label'    :'Nee'\n          });\n        }\n      }\n\n      // cardflip the card, positionattribute flips to make sure no problems arises with different lengths of the front and back of the card, finally hide the front\n      cardflip(petition_form_element);\n      let clangct=getUrlVars()['clangct'];\n      if(clangct != undefined){clang.conversion.track();}\n    },\n    error: function(){\n      // If the backend sends an error, hide the thank element and show an error urging to try again\n      // eslint-disable-next-line no-console\n      console.log('o_o');\n      var cardback = $(petition_form_element.parentNode.nextElementSibling);\n      cardback.find('*').hide('');\n      cardback.append('<p>Sorry, er gaat momenteel iets fout, probeer het nu of later opnieuw.</p>');\n      cardback.append(\n        '<a href=\\''+window.location.href +'\\' class=\"btn btn-primary btn-block\"' +\n        '\">Probeer opnieuw</a>');\n      cardflip(petition_form_element);\n    }\n  });\n});\n\n// Get the key+value from the input fields in the form\nfunction getFormObj(el) {\n  var formObj = {};\n  var inputs = $(el).serializeArray();\n  $.each(inputs, function (i, input) {\n    formObj[input.name] = input.value;\n  });\n  return formObj;\n}\n\n// Toggle the disabled state on form elements\nfunction toggleDisable(el) {\n  el.prop('disabled', !el.prop('disabled'));\n\n}\n\n// toggle the flipped class for the card parent\nfunction cardflip(el) {\n  let element = $(el);\n  let parent =  el.parentNode;\n  let card = $(el.parentNode.parentNode);\n\n  // first hide the signing button\n  $(element.find('.signBtn')).toggle();\n  $(element.find('.policies')).toggle();\n  // then cardflip the position attribute on the front and back of the card to support different lengths front and back\n  $(parent.nextElementSibling).css( 'position', flip_positionattribute(parent.nextElementSibling));\n  $(parent).css( 'position', flip_positionattribute(parent));\n  // then cardflip the card\n  card.toggleClass('flipped');\n\n  // after animation hide the front\n  card.one('webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend',\n    function() {\n      $(parent).toggle();\n      card.off('webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend');\n    });\n\n}\n\nfunction flip_positionattribute (el){\n  return $(el).css('position') === 'absolute' ? 'relative' : 'absolute';\n}\n\n/* eslint-disable */\nfunction fireShareEvent (platform, form_id){\n  if (typeof dataLayer !== 'undefined') {\n    let form_config = 'petition_form_object_' + form_id;\n    dataLayer.push({\n      'event'         :'petitiebutton',\n      'conv_campaign' :window[form_config].analytics_campaign,\n      'conv_action'   :window[form_config].ga_action,\n      'conv_label'    :'share_' + platform});\n  }\n  else{\n    console.log('GTM not defined?');\n  }\n}\n/* eslint-enable */\n\n/* eslint-disable */\n// Send the supporter data to for deduplication\nfunction socialBlueDeDuplicate(email, phone, apref) {\n  var apHost = ('https:' == document.location.protocol ? 'https://secure.event.' : 'http://www.') + 'affiliatepartners.com';\n  var apSrc = '/js/ApConversionPixelV1.1.js';\n\n  _apOrderValue = 0;\n  _apOrderNumber = 'email=' + email + '-telefoonnumer=' + phone;\n  _apRef = apref;\n\n  try {\n    $('body').append(unescape('%3Cscript src=\\'' + apHost + apSrc + '\\' type=\\'text/javascript\\'%3E%3C/script%3E'));\n  } catch (err) {\n    var script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = apHost + apSrc;\n    document.getElementsByTagName('head')[0].appendChild(script);\n  }\n}\n/* eslint-enable */\n\n// REFACTOR IE11 doesn't support UrlSearchParams, so custom UrlParam function.\n// \tConsider polyfilling it now? or wait until we drop IE11 support and switch then?\nfunction getUrlVars(){\n  var vars = [],\n    hash;\n  var uri = window.location.href.split('#')[0];\n  var hashes = uri.slice(window.location.href.indexOf('?') + 1).split('&');\n  for(var i = 0; i < hashes.length; i++){\n    hash = hashes[i].split('=');\n    vars.push(hash[0]);\n    vars[hash[0]] = hash[1];\n  }\n  return vars;\n}\n"]}