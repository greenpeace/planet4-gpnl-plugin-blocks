{"version":3,"sources":["gpnl-election.js"],"names":["el","getFormObj","formObj","inputs","$","serializeArray","each","i","input","cardflip","value","parent","element","prop","card","toggle","parentNode","flip_positionattribute","nextElementSibling","css","toggleClass","one","form_config","dataLayer","off","console","fireShareEvent","platform","form_id","push","event","socialBlueDeDuplicate","apHost","window","document","location","apSrc","ga_action","_apOrderValue","log","getElementsByTagName","phone","appendChild","protocol","_apOrderNumber","email","_apRef","apref","vars","append","unescape","err","uri","script","hashes","src","length","getUrlVars","hash","total","showCounter","num_responses","counter","slice","href","indexOf","split","find","perc_slider","Math","round","width","prefillByGuid","data","show","xmlhttp","XMLHttpRequest","requestValue","animate","opacity","html","fadeIn","query_id","type","form","sr","onreadystatechange","readyState","response","res","status","responseXML","firstChild","nodeValue","setRequestHeader","send","val","naam","counter_min","Number","on","id","relatedTarget","button","this","modal","config","text","title","mcode","ready","infinite","slick","mobileFirst","slidesToShow","slidesToScroll","arrows","dots","centerMode","centerPadding","initialSlide","responsive","breakpoint","settings","numOptions","opt","url_cg","isfacebook","referrer","istwitter","clangct","undefined","ajax","url","dataType","hide","keyup","test","encodeURIComponent","complete","mail","responseText","includes","num","tellerCode","analytics_campaign","petition_form_element","global_config","post_form_value","toggleDisable","nonce","hideresults"],"mappings":"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","file":"../gpnl-election.js","sourcesContent":["// Vul het modal met de juiste data\n$('#electionModal').on('show.bs.modal', function (event) {\n  var button = $(event.relatedTarget);\n  var id = button.data('id');\n  var modal = $(this);\n  var config = 'election_object_' + id;\n\n  modal.find('.modal-title').text('Stem op ' + window[config].title);\n  modal.find('.modal-subtitle').text(window[config].subtitle);\n  modal.find('.modal-body').text( window[config].description );\n  modal.find('input[name=\\'form_id\\']').val(id);\n  modal.find('input[name=\\'marketingcode\\']').val(window[config].mcode);\n});\n\n\n$(document).ready(function() {\n  // convert an element to slider using slick js\n  function slickify(element) {\n    let numOptions = $('#electionModal').data('num');\n    $(element).slick({\n      infinite: false,\n      mobileFirst: true,\n      slidesToShow: 1,\n      slidesToScroll: 1,\n      arrows: true,\n      dots: true,\n      centerMode: true,\n      centerPadding: '20px',\n      initialSlide: 3,\n      responsive: [\n        {\n          breakpoint: 992,\n          settings: {slidesToShow: numOptions}\n        },\n        {\n          breakpoint: 768,\n          settings: {slidesToShow: 3}\n        },\n        {\n          breakpoint: 576,\n          settings: {slidesToShow: 2}\n        }\n      ]\n    });\n  }\n\n  slickify('.election-options');\n\n  // Hide the consentbox if the opt=in url var is set. (this is for set for ie mailings)\n  var opt = getUrlVars()['opt'];\n  this.url_cg = getUrlVars()['cg'];\n  var isfacebook = document.referrer.indexOf('facebook') !== -1;\n  var istwitter = document.referrer.indexOf('twitter') !== -1;\n\n  let clangct = getUrlVars()['clangct'];\n\n  if (clangct != undefined) {\n    $.ajax({\n      url: '/wp-content/plugins/planet4-gpnl-plugin-blocks/includes/assets/js/clang-landing.js?clangct=' + clangct,\n      dataType: 'script',\n    });\n  }\n\n  if (opt != undefined && $('.optin').length != 0 && opt == 'in') {\n    $('.optin').hide();\n    $('.gpnl-petition-checkbox').prop('checked', true);\n\n    // Here we check if we know the mail being entered if the opt=in var is set.\n    // If we don't know the entered mail we should display the consentbox\n    $('input[name=\\'mail\\']').keyup(function () {\n      // First loosely check if the value in the mailinput is indeed a mailadress, if it indeed is, we pass it onto the database checker\n      // eslint-disable-next-line\n      var mailRegex = /^(([^<>()\\[\\]\\.,;:\\s@\\\"]+(\\.[^<>()\\[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{3,})$/i;\n      if (mailRegex.test(this.value)) {\n        let mail = encodeURIComponent(this.value);\n        $.ajax({\n          type: 'GET',\n          url: 'https://secure.greenpeacephp.nl/kenikdeze.php?mail=' + mail,\n          complete: function (data) {\n            // If we do not know the email, we display the consentbox again\n            if (data.responseText.includes('false')) {\n              $('.optin').show();\n              $('.gpnl-petition-checkbox').prop('checked', false);\n            }\n          }\n        });\n      }\n    });\n\n    if (!(istwitter || isfacebook) && url_cg != undefined) {\n      prefillByGuid('prefill', this);\n    }\n  }\n\n  let config = 'election_object';\n  // totaal aantal stemmen opvragen\n  let form = {\n    tellerCode: window[config].analytics_campaign,\n  };\n  let num = prefillByGuid('teller', form);\n  $('#counter_total').data('num', num);\n  $('#counter_total').text(num + ' stemmen');\n\n});\n\n$('.gpnl-petitionform').on('submit', function () {\n  var petition_form_element = this;\n  // Get the  parameter from the petition form and add the action and CSRF protection\n  var post_form_value = getFormObj(petition_form_element);\n  var global_config = 'election_object';\n\n  post_form_value.action = 'petition_form_process';\n  post_form_value.nonce  = window[global_config].nonce;\n  // post_form_value.ad_campaign = window[form_config].ad_campaign;\n\n  // Disable the form so people can't resubmit\n  toggleDisable($(petition_form_element).find('*'));\n  toggleDisable($('.btn-submit'));\n\n\n  // Do a ajax call to the wp_admin admin_ajax.php,\n  // which triggers processing function in the petition block\n  // $.ajax({\n  //   type:    'POST',\n  //   url:     window[form_config].ajaxUrl,\n  //   data:    post_form_value,\n  //   success: function(data) {\n  //     // eslint-disable-next-line no-console\n  //     console.log('^-^');\n\n\n  if ( !global_config.hideresults ) {\n    // opvragen stemmen per opties (verborgen tot na stemmen)\n    $('.subcounter').each(function(){\n      let id = $(this).data('id');\n      let form_config = 'election_object_' + id;\n      this.tellerCode = form_config.mcode;\n      let num_option = prefillByGuid('teller', this);\n      showCounter(num_option, this);\n    });\n  }\n  //\n  //     // Send conversion event to the GTM\n  //     if (typeof dataLayer !== 'undefined') {\n  //       dataLayer.push({\n  //         'event'         :'petitiebutton',\n  //         'conv_campaign' : window[form_config].analytics_campaign,\n  //         'conv_action'   : window[form_config].ga_action,\n  //         'conv_label'    :'registreer'\n  //       });\n  //     }\n  //\n  //     // if consent was given by entering phonenumber\n  //     if (post_form_value.phone !== '') {\n  //       // Send conversion event to the GTM\n  //       if (typeof dataLayer !== 'undefined') {\n  //         dataLayer.push({\n  //           'event'         :'petitiebutton',\n  //           'conv_campaign' : window[form_config].analytics_campaign,\n  //           'conv_action'   :'telnr',\n  //           'conv_label'    :'Ja'\n  //         });\n  //       }\n  //       // If an ad campaign is run by an external company fire the conversiontracking\n  //       if (window[form_config].ad_campaign === 'SB') {\n  //         fbq('track', 'Lead');\n  //         // if it is run by social blue, also deduplicate\n  //         socialBlueDeDuplicate(post_form_value['mail'], data['data']['phone'], window[form_config].apref);\n  //       } else if (window[form_config].ad_campaign === 'JA') {\n  //         fbq('track', window[form_config].jalt_track);\n  //       }\n  //     }\n  //     else{\n  //       if (typeof dataLayer !== 'undefined') {\n  //         dataLayer.push({\n  //           'event'         :'petitiebutton',\n  //           'conv_campaign' : window[form_config].analytics_campaign,\n  //           'conv_action'   :'telnr',\n  //           'conv_label'    :'Nee'\n  //         });\n  //       }\n  //     }\n  //\n  //     // cardflip the card, positionattribute flips to make sure no problems arises with different lengths of the front and back of the card, finally hide the front\n  cardflip(petition_form_element);\n\n  // Bedankt melding verbergen na sluiten van modal window?\n  // $('#electionModal').on('hidden.bs.modal', function () {\n  //   $($('.gpnl-petition-thank')[0]).hide();\n  // });\n  //     let clangct=getUrlVars()['clangct'];\n  //     if(clangct != undefined){clang.conversion.track();}\n  //   },\n  //   error: function(){\n  //     // If the backend sends an error, hide the thank element and show an error urging to try again\n  //     // eslint-disable-next-line no-console\n  //     console.log('o_o');\n  //     var cardback = $(petition_form_element.parentNode.nextElementSibling);\n  //     cardback.find('*').hide('');\n  //     cardback.append('<p>Sorry, er gaat momenteel iets fout, probeer het nu of later opnieuw.</p>');\n  //     cardback.append(\n  //       '<a href=\\''+window.location.href +'\\' class=\"btn btn-primary btn-block\"' +\n  //       '\">Probeer opnieuw</a>');\n  //     cardflip(petition_form_element);\n  //   }\n  // });\n});\n\n// Get the key+value from the input fields in the form\nfunction getFormObj(el) {\n  var formObj = {};\n  var inputs = $(el).serializeArray();\n  $.each(inputs, function (i, input) {\n    formObj[input.name] = input.value;\n  });\n  return formObj;\n}\n\n// Toggle the disabled state on form elements\nfunction toggleDisable(el) {\n  el.prop('disabled', !el.prop('disabled'));\n\n}\n\n// toggle the flipped class for the card parent\nfunction cardflip(el) {\n  let element = $(el);\n  let parent =  el.parentNode;\n  let card = $(el.parentNode.parentNode);\n\n  // first hide the signing button\n  $('.btn-submit').toggle();\n  $(element.find('.policies')).toggle();\n  // then cardflip the position attribute on the front and back of the card to support different lengths front and back\n  $(parent.nextElementSibling).css( 'position', flip_positionattribute(parent.nextElementSibling));\n  $(parent).css( 'position', flip_positionattribute(parent));\n  // then cardflip the card\n  card.toggleClass('flipped');\n\n  // after animation hide the front\n  card.one('webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend',\n    function() {\n      $(parent).toggle();\n      card.off('webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend');\n    });\n\n}\n\nfunction flip_positionattribute (el){\n  return $(el).css('position') === 'absolute' ? 'relative' : 'absolute';\n}\n\n/* eslint-disable */\nfunction fireShareEvent (platform, form_id){\n  if (typeof dataLayer !== 'undefined') {\n    let form_config = 'petition_form_object_' + form_id;\n    dataLayer.push({\n      'event'         :'petitiebutton',\n      'conv_campaign' :window[form_config].analytics_campaign,\n      'conv_action'   :window[form_config].ga_action,\n      'conv_label'    :'share_' + platform});\n  }\n  else{\n    console.log('GTM not defined?');\n  }\n}\n/* eslint-enable */\n\n/* eslint-disable */\n// Send the supporter data to for deduplication\nfunction socialBlueDeDuplicate(email, phone, apref) {\n  var apHost = ('https:' == document.location.protocol ? 'https://secure.event.' : 'http://www.') + 'affiliatepartners.com';\n  var apSrc = '/js/ApConversionPixelV1.1.js';\n\n  _apOrderValue = 0;\n  _apOrderNumber = 'email=' + email + '-telefoonnumer=' + phone;\n  _apRef = apref;\n\n  try {\n    $('body').append(unescape('%3Cscript src=\\'' + apHost + apSrc + '\\' type=\\'text/javascript\\'%3E%3C/script%3E'));\n  } catch (err) {\n    var script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = apHost + apSrc;\n    document.getElementsByTagName('head')[0].appendChild(script);\n  }\n}\n/* eslint-enable */\n\n// REFACTOR IE11 doesn't support UrlSearchParams, so custom UrlParam function.\n// \tConsider polyfilling it now? or wait until we drop IE11 support and switch then?\nfunction getUrlVars(){\n  var vars = [],\n    hash;\n  var uri = window.location.href.split('#')[0];\n  var hashes = uri.slice(window.location.href.indexOf('?') + 1).split('&');\n  for(var i = 0; i < hashes.length; i++){\n    hash = hashes[i].split('=');\n    vars.push(hash[0]);\n    vars[hash[0]] = hash[1];\n  }\n  return vars;\n}\n\n\n// TODO add language preference detection for better formatting of numbers\nfunction showCounter(num_responses, counter){\n  let total = $('#counter_total').data('num');\n  $(counter).find('.counter').show();\n  let perc_slider = Math.round(100 *(num_responses / total));\n\n  $(counter).find('.counter__slider').animate({width: perc_slider+'%', opacity: 1}, 2000, 'easeInOutCubic');\n  $(counter).find('.counter__gettext').html(perc_slider + '% van de stemmen');\n  $(counter).find('.counter__text').fadeIn(2000);\n}\n\n// soap request naar charibase\nfunction prefillByGuid(type, form) {\n  var config = 'election_object';\n  var xmlhttp = new XMLHttpRequest();\n  var query_id = '';\n  var requestValue = '';\n  // waar gaat het om? Een teller of een prefill?\n  if (type === 'prefill') {\n    query_id = 'GET_FIRST_NAME_EMAIL';\n    requestValue = form.url_cg;\n  } else if (type === 'teller') {\n    query_id = 'CAMP_TTL_PETITIONS';\n    requestValue = form.tellerCode;\n  }\n  xmlhttp.open('POST', 'https://www.mygreenpeace.nl/GPN.WebServices/WIDSService.asmx', true);\n  // build SOAP request\n  var sr = '<' + '?' + 'xml version=\"1.0\" encoding=\"utf-8\"?>' +\n    '<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">' +\n    '  <soap:Body>' +\n    '    <WatIsDestand xmlns=\"http://www.mygreenpeace.nl/GPN.WebServices/\">' +\n    '      <queryId>' + query_id + '</queryId>' +\n    '      <requestValue>' + requestValue + '</requestValue>' +\n    '    </WatIsDestand>' +\n    '  </soap:Body>' +\n    '</soap:Envelope>';\n\n  xmlhttp.onreadystatechange = function () {\n    if (xmlhttp.readyState === 4 && xmlhttp.status === 200) { // 200 = OK\n      var response = xmlhttp.responseXML.getElementsByTagName('WatIsDestandResult')[0].firstChild.nodeValue;\n      if (response !== '') {\n        var res = response.split('|');\n        // waar gaat het om? Een teller of een prefill\n        if (type === 'prefill') {\n          var naam = res[0];\n          $(form).find('input[name=\\'name\\']').val(naam);\n          var email = res[1];\n          $(form).find('input[name=\\'mail\\']').val(email);\n        } else if (type === 'teller') {\n          if (res[0] >= config.counter_min) {\n            return Number(res[0]);\n          }\n        }\n      }\n    }\n  };\n  // Send the POST request\n  xmlhttp.setRequestHeader('Content-Type', 'text/xml');\n  xmlhttp.setRequestHeader('SOAPAction', 'http://www.mygreenpeace.nl/GPN.WebServices/WatIsDestand');\n  xmlhttp.send(sr);\n  // send request\n}\n"]}