{"version":3,"sources":["gpnl-election.js"],"names":["getFormObj","el","formObj","cardflip","element","$","serializeArray","each","parent","parentNode","input","prop","card","off","toggle","find","nextElementSibling","css","flip_positionattribute","fireShareEvent","platform","toggleClass","form_config","one","form_id","dataLayer","socialBlueDeDuplicate","apref","push","apSrc","_apOrderValue","window","analytics_campaign","_apOrderNumber","email","ga_action","_apRef","log","append","phone","apHost","document","location","protocol","getUrlVars","uri","href","hashes","script","createElement","i","hash","vars","getElementsByTagName","appendChild","showCounter","perc_slider","show","slice","round","num_responses","total","split","counter","length","width","opacity","prefillByGuid","config","data","XMLHttpRequest","query_id","Math","animate","html","fadeIn","requestValue","type","tellerCode","xmlhttp","onreadystatechange","readyState","response","form","open","sr","status","Number","firstChild","nodeValue","res","naam","val","setRequestHeader","counter_min","text","send","on","event","id","relatedTarget","button","this","modal","title","mcode","ready","numOptions","slick","infinite","mobileFirst","slidesToShow","slidesToScroll","arrows","dots","centerMode","centerPadding","initialSlide","responsive","breakpoint","settings","opt","isfacebook","referrer","indexOf","clangct","undefined","ajax","url","dataType","hide","keyup","test","value","mail","encodeURIComponent","complete","responseText","includes","istwitter","url_cg","post_form_value","ad_campaign","global_config","action","nonce","success","ajaxUrl","console","conv_action","conv_label","fbq","jalt_track","petition_form_element","conv_campaign","cardback","clang","error","inputs","name"],"mappings":"aAoNA,SAASA,WAAWC,GAgBpB,IAAAC,EAASC,GACHC,EAAOC,EAAIJ,GAAfK,iBAKAD,OAJAA,EAAAE,KAAIC,EAAY,SAACC,EAAjBC,GACAR,EAAQQ,EAAQD,MAAAA,EAAWA,QAGzBP,EAIFG,SAAEG,cAAaP,GAffA,EAAGU,KAAK,YAAaV,EAAGU,KAAK,aAuBzBC,SAAKC,SAAIZ,GACV,IAJHG,EAAAC,EAAAJ,GAMDO,EAAAP,EAAAQ,WAlBKG,EAAOP,EAAEJ,EAAGQ,WAAWA,YAsB5BJ,EAAA,eAAAS,SAEDT,EAAAD,EAAAW,KAAA,cAAAD,SAlBET,EAAEG,EAAOQ,oBAAoBC,IAAK,WAAYC,uBAAuBV,EAAOQ,qBAmB9EX,EAAAG,GAASW,IAAAA,WAAgBC,uBAAkBZ,IAEvCI,EAAAS,YAAIC,WAEFV,EAAAW,IAAA,kFACA,WACAlB,EAAAG,GAAAM,SACAF,EAAAC,IAAA,qFAKL,SAAAK,uBAAAjB,GACD,MAAA,aAAAI,EAAAJ,GAAAgB,IAAA,YAAA,WAAA,WAbA,SAASE,eAAgBC,EAAUI,GACjC,GAAyB,oBAAdC,UAA2B,CAgBxC,IAAAH,EAASI,wBAAoCC,EAC3CF,UAAUG,KAAI,CACVC,MAAQ,gBAEZC,cAAAC,OAAAT,GAAAU,mBACAC,YAAiBF,OAAWG,GAAQC,UACpCC,WAAA,SAAAhB,SAGEf,QAACgC,IAASC,oBAOb,SAAAZ,sBAAAQ,EAAAK,EAAAZ,GACD,IAAAa,GAAA,UAAAC,SAAAC,SAAAC,SAAA,wBAAA,eAAA,wBAEAd,EAAA,+BAfEC,cAAgB,EAChBG,eAAiB,SAAWC,EAAQ,kBAAoBK,EAgB1DH,OAASQ,EACP,IAEAvC,EAAIwC,QAAMd,OAAOW,SAASI,kBAA1BN,EAAAX,EAAA,6CACA,MAAIkB,GAdF,IAAIC,EAASP,SAASQ,cAAc,UAetCD,EAAQE,KAAOA,kBACbC,EAAOJ,IAAMP,EAANX,EACPuB,SAAAC,qBAAA,QAAA,GAAAC,YAAAN,IAPJ,SAASJ,aAmBPvC,IALF,IACE8C,EADFC,EAASG,GAGHC,EADJzB,OAAgBW,SAAhBI,KAA4BW,MAA5B,KAAA,GACeC,MAAQC,OAAMjB,SAAMkB,KAAAA,QAAgBC,KAAnD,GAAAC,MAAA,KAEEC,EAAShD,EAAXmC,EAAgBH,EAAAiB,OAAhBd,IAA6Ce,EAAOT,EAAAA,GAAAA,MAAY,KAAKU,EAAAA,KAASf,EAAA,IAA9EC,EAAAD,EAAwF,IAAAA,EAAA,GAExF9C,OAAE0D,EAIJ,SAASI,YAAAA,EAA0BJ,GACjC,IAAIK,EAAM/D,EAAG0B,kBAAOsC,KAAD,OACnBhE,EAAA0D,GAAWhD,KAAG,YAAIuD,OAClB,IAAIC,EAAJC,KAAAb,MAAAC,EAAAC,EAAA,KATAxD,EAAE0D,GAAShD,KAAK,oBAAoB0D,QAAQ,CAACR,MAAOT,EAAY,IAAKU,QAAS,GAAI,IAAM,kBAYxF7D,EAAA0D,GAAQhD,KAAK,qBAAW2D,KAAAlB,EAAA,oBACtBe,EAAAA,GAAQxD,KAAG,kBAAA4D,OAAX,KAIAC,SAAAA,cAAmBC,EAACC,GACrB,IAAAV,EAAArC,OAAA,gBAVGgD,EAAU,IAAIT,eAWlBS,EAAa,GATTH,EAAe,GAEN,YAATC,GAmBJE,EAAQC,uBACNJ,EAAYK,EAAAA,QAA8C,WAAAJ,IACxDN,EAAIW,qBAhBNN,EAAeO,EAAKL,YAkBhBC,EAAAK,KAAO,OAAGF,gEACV,GACA,IAAAG,EAAA,oTAIed,EAAA,iCACKK,EAAU,mEAKzBG,EAAAC,mBAAA,WAfT,GAA2B,IAAvBD,EAAQE,YAAuC,MAAnBF,EAAQO,OAAgB,CAgBhD,IAAAJ,EAAOK,EAAOL,YAAd7B,qBAAA,sBAAA,GAAAmC,WAAAC,UACD,GAAA,KAAAP,EAAA,CACF,IAAAQ,EAAAR,EAAApB,MAAA,KAEJ,GAAA,YAAAe,EAAA,CAEH,IAAAc,EAAAD,EAAA,GAfQrF,EAAE8E,GAAMpE,KAAK,sBAAwB6E,IAAID,GACzC,IAAIzD,EAAQwD,EAAI,GAehBG,EAAAA,GAAAA,KAAAA,sBAAiCD,IAAA1D,QACjC2D,GAAiB,WAAjBA,GACRN,OACAL,IAAAd,EAAA0B,YAVU,MAWX,UAAAX,EAAAN,OAdaxE,EAAE,kBAAkBgE,KAAK,MAAOa,GAChC7E,EAAE,kBAAkB0F,KAAKb,EAAW,aAE/BK,OAAOL,MAOxBH,EAAQc,iBAAiB,eAAgB,YACzCd,EAAQc,iBAAiB,aAAc,2DACvCd,EAAQiB,KAAKX,GAjXfhF,EAAE,kBAAkB4F,GAAG,gBAAiB,SAAUC,GADlD,IACEC,EADF9F,EAAA6F,EAAAE,eACC/B,KAAsB,MACjBgC,EAAMhG,EAAIiG,MACVH,EAAKE,mBAATF,EAEAI,EAAInC,KAAM,gBAAG2B,KAAA,WAAbhE,OAAAqC,GAAAoC,OAEAD,EAAMxF,KAAK,mBAAgBgF,KAAKhE,OAAAqC,GAAarC,UAC7CwE,EAAMxF,KAAK,eAAAgF,KAAmBA,OAAKhE,GAAOqC,aAC1CmC,EAAMxF,KAAK,yBAA4BqD,IAAAA,GACvCmC,EAAMxF,KAAK,+BAAX6E,IAAA7D,OAAAqC,GAAAqC,SAIFpG,EAAEoC,UAAUiE,MAAM,WAEhB,IAAkBtG,EACZuG,EADYvG,EA2BjB,oBA1BKuG,EAAatG,EAAE,kBAAkBgE,KAAK,OAC1ChE,EAAED,GAASwG,MAAM,CACfC,UAAU,EACVC,aAAa,EACbC,aAAc,EACdC,eAAgB,EAChBC,QAAQ,EACRC,MAAM,EACNC,YAAY,EACZC,cAAe,OACfC,aAAc,EACdC,WAAY,CAERC,CACAC,WAAU,IAACT,SAAAA,CAAAA,aAAcJ,IAHjB,CAMRY,WAAY,IACZC,SAAU,CAAAT,aAAA,IAAA,CAEZQ,WAAA,IACEA,SAAY,CAAAR,aADd,OAWN,IAAIU,EAAM7E,aAAU,IAApB0D,KAAImB,OAAM7E,aAAa,GACvB,IAAA8E,GAAA,IAAc9E,SAAU+E,SAAxBC,QAAA,YACIF,GAAa,IAAHjF,SAAWkF,SAARC,QAAA,WAGbC,EAAUjF,aAAU,QAETkF,MAAXD,GACFxH,EAAE0H,KAAK,CACLC,IAAK,8FAAgGH,EACrGI,SAAU,WAIHH,MAAPL,GAA0C,GAAtBpH,EAAE,UAAU2D,QAAsB,MAAPyD,IACjDpH,EAAE,UAAU6H,OACZ7H,EAAE,2BAA2BM,KAAK,WAAW,GAK3CN,EAAA,sBAAA8H,MAAA,WAGA,GADgB,yHACFC,KAAK9B,KAAK+B,OAAQ,CAC9B,IAAIC,EAAOC,mBAAmBjC,KAAK+B,OACnChI,EAAE0H,KAAK,CACLlD,KAAM,MACNmD,IAAK,sDAAwDM,EAC7DE,SAAU,SAAAnE,GAEJA,EAAKoE,aAAaC,SAAS,WAC7BrI,EAAE,UAAUoD,OACZpD,EAAE,2BAA2BM,KAAK,WAAW,UAOjDgI,GAAajB,GAAyBI,MAAVc,QAChCzE,cAAc,UAAWmC,OAU7BnC,cAAc,SAJH,CACTW,WAAY/C,OAAM,gBAASC,mBAC3B6C,KAAM,YAMVxE,EAAE,sBAAsB4F,GAAG,SAAU,WASnC4C,IAAAA,EAAyBvC,KAEzBuC,EAAgBC,WAAc/G,GAL1BgH,EAAgB,kBAYpBF,EAAAG,OAAA,wBARAH,EAAgBI,MAASlH,OAAOgH,GAAeE,MAS/C5I,EAAOyI,YAAA/G,OAAAgH,GAAAD,YAGLzE,cAASwE,EAAAA,GAHJ9H,KAAA,MAILmI,cAAS7I,EAAA,gBAMPA,EAAA0H,KAAA,CACAlD,KAAA,OACAmD,IAAAjG,OAAAgH,GAAAI,QACA9E,KAAAwE,EACAK,QAAA,SAAA7E,GAEA+E,QAAA/G,IAAA,OAcI,oBAAAwG,WACFpH,UAAAG,KAAA,CACAsE,MAAWzE,gBACTA,cAAeH,YAAAU,mBACbqH,YAAiB/H,YADJa,UAEbmH,WAAA,eALwB,KAA1BT,EAAgBtG,OAWMuG,oBAAbxH,WACTiI,UAAI3H,KAAS,CARXsE,MAAiB,gBAUnBxE,cAAAA,OAAsBmH,aAAgB7G,mBAHxCqH,YAIkB/H,QAChBiI,WAAmB,OAKJ,OAAf9H,OAASH,aAAMwH,aACbS,IAAA,QAAiB,QAEjB7H,sBAAiBmH,EAHJ,KAAAxE,EAAA,KAAA,MAAAtC,OAAAT,aAAAK,QAII,OAAjBI,OAAiBT,aAAAwH,aAJJS,IAAf,QAAAxH,OAAAT,aAAAkI,aADuB,oBAAd/H,WAWbtB,UAASsJ,KAAAA,CACTL,MAAkBjF,gBATZuF,cAAkB3H,OAAOT,aAAaU,mBAa1CqH,YAAqB,QACjBC,WAAA,QAG6CnJ,SAAAsJ,GAtEhDL,QAAA/G,IAAA8B,cAAA,SAAApC,OAAAgH,KA2EHK,EAAAA,kBAAAnD,GAAA,kBAAA,WACA5F,EAAIsJ,EAAAA,wBAAaF,IAAAA,SAGRnH,MADAA,aAAO,SAEdsH,MAAa7H,WAAOW,SAGvBmH,MAAA,WARCT,QAAQ/G,IAAI,OAelB,IAASrC,EAAWC,EAApBwJ,EAAwBhJ,WAAAO,oBAClBd,EAAOa,KAAX,KAAAmH,KAAA,IACI4B,EAASzJ,OAAMC,+EACjBC,EAAF+B,OACEpC,YAAc6J,OAAQrJ,SAAtBoC,KAAA,6DAEF3C,SAAOD","file":"../gpnl-election.js","sourcesContent":["// Vul het modal met de juiste data\n$('#electionModal').on('show.bs.modal', function (event) {\n  var button = $(event.relatedTarget);\n  var id = button.data('id');\n  var modal = $(this);\n  var config = 'election_object_' + id;\n\n  modal.find('.modal-title').text('Stem op ' + window[config].title);\n  modal.find('.modal-subtitle').text(window[config].subtitle);\n  modal.find('.modal-body').text( window[config].description );\n  modal.find('input[name=\\'form_id\\']').val(id);\n  modal.find('input[name=\\'marketingcode\\']').val(window[config].mcode);\n});\n\n$(document).ready(function() {\n  // convert an element to slider using slick js\n  function slickify(element) {\n    let numOptions = $('#electionModal').data('num');\n    $(element).slick({\n      infinite: false,\n      mobileFirst: true,\n      slidesToShow: 1,\n      slidesToScroll: 1,\n      arrows: true,\n      dots: true,\n      centerMode: true,\n      centerPadding: '20px',\n      initialSlide: 3,\n      responsive: [\n        {\n          breakpoint: 992,\n          settings: {slidesToShow: numOptions}\n        },\n        {\n          breakpoint: 768,\n          settings: {slidesToShow: 3}\n        },\n        {\n          breakpoint: 576,\n          settings: {slidesToShow: 2}\n        }\n      ]\n    });\n  }\n\n  slickify('.election-options');\n\n  // Hide the consentbox if the opt=in url var is set. (this is for set for ie mailings)\n  var opt = getUrlVars()['opt'];\n  this.url_cg = getUrlVars()['cg'];\n  var isfacebook = document.referrer.indexOf('facebook') !== -1;\n  var istwitter = document.referrer.indexOf('twitter') !== -1;\n\n  let clangct = getUrlVars()['clangct'];\n\n  if (clangct != undefined) {\n    $.ajax({\n      url: '/wp-content/plugins/planet4-gpnl-plugin-blocks/includes/assets/js/clang-landing.js?clangct=' + clangct,\n      dataType: 'script',\n    });\n  }\n\n  if (opt != undefined && $('.optin').length != 0 && opt == 'in') {\n    $('.optin').hide();\n    $('.gpnl-petition-checkbox').prop('checked', true);\n\n    // Here we check if we know the mail being entered if the opt=in var is set.\n    // If we don't know the entered mail we should display the consentbox\n    $('input[name=\\'mail\\']').keyup(function () {\n      // First loosely check if the value in the mailinput is indeed a mailadress, if it indeed is, we pass it onto the database checker\n      // eslint-disable-next-line\n      var mailRegex = /^(([^<>()\\[\\]\\.,;:\\s@\\\"]+(\\.[^<>()\\[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{3,})$/i;\n      if (mailRegex.test(this.value)) {\n        let mail = encodeURIComponent(this.value);\n        $.ajax({\n          type: 'GET',\n          url: 'https://secure.greenpeacephp.nl/kenikdeze.php?mail=' + mail,\n          complete: function (data) {\n            // If we do not know the email, we display the consentbox again\n            if (data.responseText.includes('false')) {\n              $('.optin').show();\n              $('.gpnl-petition-checkbox').prop('checked', false);\n            }\n          }\n        });\n      }\n    });\n\n    if (!(istwitter || isfacebook) && url_cg != undefined) {\n      prefillByGuid('prefill', this);\n    }\n  }\n\n  let config = 'election_object';\n  // totaal aantal stemmen opvragen\n  let form = {\n    tellerCode: window[config].analytics_campaign,\n    type: 'total'\n  };\n  prefillByGuid('teller', form);\n});\n\n\n$('.gpnl-petitionform').on('submit', function () {\n\n\n  var petition_form_element = this;\n  // Get the  parameter from the petition form and add the action and CSRF protection\n  var post_form_value = getFormObj(petition_form_element);\n  var global_config = 'election_object';\n\n\n  post_form_value.action = 'petition_form_process';\n  post_form_value.nonce  = window[global_config].nonce;\n  post_form_value.ad_campaign = window[global_config].ad_campaign;\n\n  // Disable the form so people can't resubmit\n  toggleDisable($(petition_form_element).find('*'));\n  toggleDisable($('.btn-submit'));\n\n  // Do a ajax call to the wp_admin admin_ajax.php,\n  // which triggers processing function in the petition block\n  $.ajax({\n    type:    'POST',\n    url:     window[global_config].ajaxUrl,\n    data:    post_form_value,\n    success: function(data) {\n      // eslint-disable-next-line no-console\n      console.log('^-^');\n\n      // if (!global_config.hideresults) {\n      //   // opvragen stemmen per opties (verborgen tot na stemmen)\n      //   $('.subcounter').each(function () {\n      //     let id = $(this).data('id');\n      //     let form_config = 'election_object_' + id;\n      //     this.tellerCode = form_config.mcode;\n      //     let num_option = prefillByGuid('teller', this);\n      //     showCounter(num_option, this);\n      //   });\n      // }\n\n      // Send conversion event to the GTM\n      if (typeof dataLayer !== 'undefined') {\n        dataLayer.push({\n          'event'         :'petitiebutton',\n          'conv_campaign' : form_config.analytics_campaign,\n          'conv_action'   : form_config.ga_action,\n          'conv_label'    :'registreer'\n        });\n      }\n\n      // if consent was given by entering phonenumber\n      if (post_form_value.phone !== '') {\n        // Send conversion event to the GTM\n        if (typeof dataLayer !== 'undefined') {\n          dataLayer.push({\n            'event'         :'petitiebutton',\n            'conv_campaign' : window[form_config].analytics_campaign,\n            'conv_action'   :'telnr',\n            'conv_label'    :'Ja'\n          });\n        }\n        // If an ad campaign is run by an external company fire the conversiontracking\n        if (window[form_config].ad_campaign === 'SB') {\n          fbq('track', 'Lead');\n          // if it is run by social blue, also deduplicate\n          socialBlueDeDuplicate(post_form_value['mail'], data['data']['phone'], window[form_config].apref);\n        } else if (window[form_config].ad_campaign === 'JA') {\n          fbq('track', window[form_config].jalt_track);\n        }\n      }\n      else{\n        if (typeof dataLayer !== 'undefined') {\n          dataLayer.push({\n            'event'         :'petitiebutton',\n            'conv_campaign' : window[form_config].analytics_campaign,\n            'conv_action'   :'telnr',\n            'conv_label'    :'Nee'\n          });\n        }\n      }\n\n      // cardflip the card, positionattribute flips to make sure no problems arises with different lengths of the front and back of the card, finally hide the front\n      cardflip(petition_form_element);\n      console.log(      prefillByGuid('teller', window[global_config]));\n\n\n      // Bedankt melding verbergen na sluiten van modal window?\n      $('#electionModal').on('hidden.bs.modal', function () {\n        $($('.gpnl-petition-thank')[0]).hide();\n      });\n      let clangct=getUrlVars()['clangct'];\n      if(clangct != undefined){clang.conversion.track();}\n    },\n    error: function(){\n      // If the backend sends an error, hide the thank element and show an error urging to try again\n      // eslint-disable-next-line no-console\n      console.log('o_o');\n      var cardback = $(petition_form_element.parentNode.nextElementSibling);\n      cardback.find('*').hide('');\n      cardback.append('<p>Sorry, er gaat momenteel iets fout, probeer het nu of later opnieuw.</p>');\n      cardback.append(\n        '<a href=\\''+window.location.href +'\\' class=\"btn btn-primary btn-block\"' +\n        '\">Probeer opnieuw</a>');\n      cardflip(petition_form_element);\n    }\n  });\n\n\n});\n\n// Get the key+value from the input fields in the form\nfunction getFormObj(el) {\n  var formObj = {};\n  var inputs = $(el).serializeArray();\n  $.each(inputs, function (i, input) {\n    formObj[input.name] = input.value;\n  });\n  return formObj;\n}\n\n// Toggle the disabled state on form elements\nfunction toggleDisable(el) {\n  el.prop('disabled', !el.prop('disabled'));\n\n}\n\n// toggle the flipped class for the card parent\nfunction cardflip(el) {\n  let element = $(el);\n  let parent =  el.parentNode;\n  let card = $(el.parentNode.parentNode);\n\n  // first hide the signing button\n  $('.btn-submit').toggle();\n  $(element.find('.policies')).toggle();\n  // then cardflip the position attribute on the front and back of the card to support different lengths front and back\n  $(parent.nextElementSibling).css( 'position', flip_positionattribute(parent.nextElementSibling));\n  $(parent).css( 'position', flip_positionattribute(parent));\n  // then cardflip the card\n  card.toggleClass('flipped');\n\n  // after animation hide the front\n  card.one('webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend',\n    function() {\n      $(parent).toggle();\n      card.off('webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend');\n    });\n\n}\n\nfunction flip_positionattribute (el){\n  return $(el).css('position') === 'absolute' ? 'relative' : 'absolute';\n}\n\n/* eslint-disable */\nfunction fireShareEvent (platform, form_id){\n  if (typeof dataLayer !== 'undefined') {\n    let form_config = 'petition_form_object_' + form_id;\n    dataLayer.push({\n      'event'         :'petitiebutton',\n      'conv_campaign' :window[form_config].analytics_campaign,\n      'conv_action'   :window[form_config].ga_action,\n      'conv_label'    :'share_' + platform});\n  }\n  else{\n    console.log('GTM not defined?');\n  }\n}\n/* eslint-enable */\n\n/* eslint-disable */\n// Send the supporter data to for deduplication\nfunction socialBlueDeDuplicate(email, phone, apref) {\n  var apHost = ('https:' == document.location.protocol ? 'https://secure.event.' : 'http://www.') + 'affiliatepartners.com';\n  var apSrc = '/js/ApConversionPixelV1.1.js';\n\n  _apOrderValue = 0;\n  _apOrderNumber = 'email=' + email + '-telefoonnumer=' + phone;\n  _apRef = apref;\n\n  try {\n    $('body').append(unescape('%3Cscript src=\\'' + apHost + apSrc + '\\' type=\\'text/javascript\\'%3E%3C/script%3E'));\n  } catch (err) {\n    var script = document.createElement('script');\n    script.type = 'text/javascript';\n    script.src = apHost + apSrc;\n    document.getElementsByTagName('head')[0].appendChild(script);\n  }\n}\n/* eslint-enable */\n\n// REFACTOR IE11 doesn't support UrlSearchParams, so custom UrlParam function.\n// \tConsider polyfilling it now? or wait until we drop IE11 support and switch then?\nfunction getUrlVars(){\n  var vars = [],\n    hash;\n  var uri = window.location.href.split('#')[0];\n  var hashes = uri.slice(window.location.href.indexOf('?') + 1).split('&');\n  for(var i = 0; i < hashes.length; i++){\n    hash = hashes[i].split('=');\n    vars.push(hash[0]);\n    vars[hash[0]] = hash[1];\n  }\n  return vars;\n}\n\n// TODO add language preference detection for better formatting of numbers\nfunction showCounter(num_responses, counter){\n  let total = $('#counter_total').data('num');\n  $(counter).find('.counter').show();\n  let perc_slider = Math.round(100 *(num_responses / total));\n\n  $(counter).find('.counter__slider').animate({width: perc_slider+'%', opacity: 1}, 2000, 'easeInOutCubic');\n  $(counter).find('.counter__gettext').html(perc_slider + '% van de stemmen');\n  $(counter).find('.counter__text').fadeIn(2000);\n}\n\n// soap request naar charibase\nfunction prefillByGuid(type, form) {\n  var config = window['election_object'];\n  var xmlhttp = new XMLHttpRequest();\n  var query_id = '';\n  var requestValue = '';\n  // waar gaat het om? Een teller of een prefill?\n  if (type === 'prefill') {\n    query_id = 'GET_FIRST_NAME_EMAIL';\n    requestValue = form.url_cg;\n  } else if (type === 'teller') {\n    query_id = 'CAMP_TTL_PETITIONS';\n    requestValue = form.tellerCode;\n  }\n  xmlhttp.open('POST', 'https://www.mygreenpeace.nl/GPN.WebServices/WIDSService.asmx', true);\n  // build SOAP request\n  var sr = '<' + '?' + 'xml version=\"1.0\" encoding=\"utf-8\"?>' +\n    '<soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">' +\n    '  <soap:Body>' +\n    '    <WatIsDestand xmlns=\"http://www.mygreenpeace.nl/GPN.WebServices/\">' +\n    '      <queryId>' + query_id + '</queryId>' +\n    '      <requestValue>' + requestValue + '</requestValue>' +\n    '    </WatIsDestand>' +\n    '  </soap:Body>' +\n    '</soap:Envelope>';\n\n  xmlhttp.onreadystatechange = function () {\n    if (xmlhttp.readyState === 4 && xmlhttp.status === 200) { // 200 = OK\n      var response = xmlhttp.responseXML.getElementsByTagName('WatIsDestandResult')[0].firstChild.nodeValue;\n      if (response !== '') {\n        var res = response.split('|');\n        // waar gaat het om? Een teller of een prefill\n        if (type === 'prefill') {\n          var naam = res[0];\n          $(form).find('input[name=\\'name\\']').val(naam);\n          var email = res[1];\n          $(form).find('input[name=\\'mail\\']').val(email);\n        } else if (type === 'teller') {\n          if (Number(response) >= config.counter_min) {\n            if (form.type === 'total'){\n              $('#counter_total').data('num', response);\n              $('#counter_total').text(response + ' stemmen');\n            }\n            return Number(response);\n          }\n        }\n      }\n    }\n  };\n  // Send the POST request\n  xmlhttp.setRequestHeader('Content-Type', 'text/xml');\n  xmlhttp.setRequestHeader('SOAPAction', 'http://www.mygreenpeace.nl/GPN.WebServices/WatIsDestand');\n  xmlhttp.send(sr);\n  // send request\n}\n"]}