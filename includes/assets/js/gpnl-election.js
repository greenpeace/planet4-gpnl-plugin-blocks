"use strict";function getFormObj(e){var n={},t=$(e).serializeArray();return $.each(t,function(e,t){n[t.name]=t.value}),n}function toggleDisable(e){e.prop("disabled",!e.prop("disabled"))}function cardflip(e){var t=$(e),n=e.parentNode,i=$(e.parentNode.parentNode);$(".btn-submit").toggle(),$(t.find(".policies")).toggle(),$(n.nextElementSibling).css("position",flip_positionattribute(n.nextElementSibling)),$(n).css("position",flip_positionattribute(n)),i.toggleClass("flipped"),i.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){$(n).toggle(),i.off("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend")})}function flip_positionattribute(e){return"absolute"===$(e).css("position")?"relative":"absolute"}function fireShareEvent(e,t){if("undefined"!=typeof dataLayer){var n="petition_form_object_"+t;dataLayer.push({event:"petitiebutton",conv_campaign:window[n].analytics_campaign,conv_action:window[n].ga_action,conv_label:"share_"+e})}else console.log("GTM not defined?")}function socialBlueDeDuplicate(e,t,n){var i=("https:"==document.location.protocol?"https://secure.event.":"http://www.")+"affiliatepartners.com",o="/js/ApConversionPixelV1.1.js";_apOrderValue=0,_apOrderNumber="email="+e+"-telefoonnumer="+t,_apRef=n;try{$("body").append(unescape("%3Cscript src='"+i+o+"' type='text/javascript'%3E%3C/script%3E"))}catch(e){var a=document.createElement("script");a.type="text/javascript",a.src=i+o,document.getElementsByTagName("head")[0].appendChild(a)}}function getUrlVars(){for(var e,t=[],n=window.location.href.split("#")[0].slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<n.length;i++)e=n[i].split("="),t.push(e[0]),t[e[0]]=e[1];return t}function showCounter(e,t){var n=$("#counter_total").data("num");$(t).find(".counter").show();var i=Math.round(e/n*100);$(t).find(".counter__slider").animate({width:i+"%",opacity:1},2e3,"easeInOutCubic"),$(t).find(".counter__gettext").html(i+"% van de stemmen"),$(t).find(".counter__text").fadeIn(2e3)}function prefillByGuid(o,a){var r=window.election_object,l=new XMLHttpRequest,e="",t="";"prefill"===o?(e="GET_FIRST_NAME_EMAIL",t=a.url_cg):"teller"===o&&(e="CAMP_TTL_PETITIONS",t=a.tellerCode),l.open("POST","https://www.mygreenpeace.nl/GPN.WebServices/WIDSService.asmx",!0);var n='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">  <soap:Body>    <WatIsDestand xmlns="http://www.mygreenpeace.nl/GPN.WebServices/">      <queryId>'+e+"</queryId>      <requestValue>"+t+"</requestValue>    </WatIsDestand>  </soap:Body></soap:Envelope>";l.onreadystatechange=function(){if(4===l.readyState&&200===l.status){var e=l.responseXML.getElementsByTagName("WatIsDestandResult")[0].firstChild.nodeValue;if(""!==e){var t=e.split("|");if("prefill"===o){var n=t[0];$(a).find("input[name='name']").val(n);var i=t[1];$(a).find("input[name='mail']").val(i)}else if("teller"===o&&Number(e)>=r.counter_min)return"total"===a.type&&($("#counter_total").data("num",e),$("#counter_total").text(e+" stemmen")),Number(e)}}},l.setRequestHeader("Content-Type","text/xml"),l.setRequestHeader("SOAPAction","http://www.mygreenpeace.nl/GPN.WebServices/WatIsDestand"),l.send(n)}$("#electionModal").on("show.bs.modal",function(e){var t=$(e.relatedTarget).data("id"),n=$(this),i="election_object_"+t;n.find(".modal-title").text("Stem op "+window[i].title),n.find(".modal-subtitle").text(window[i].subtitle),n.find(".modal-body").text(window[i].description),n.find("input[name='form_id']").val(t),n.find("input[name='marketingcode']").val(window[i].mcode)}),$(document).ready(function(){var e,t;e=".election-options",t=$("#electionModal").data("num"),$(e).slick({infinite:!1,mobileFirst:!0,slidesToShow:1,slidesToScroll:1,arrows:!0,dots:!0,centerMode:!0,centerPadding:"20px",initialSlide:3,responsive:[{breakpoint:992,settings:{slidesToShow:t}},{breakpoint:768,settings:{slidesToShow:3}},{breakpoint:576,settings:{slidesToShow:2}}]});var n=getUrlVars().opt;this.url_cg=getUrlVars().cg;var i=-1!==document.referrer.indexOf("facebook"),o=-1!==document.referrer.indexOf("twitter"),a=getUrlVars().clangct;null!=a&&$.ajax({url:"/wp-content/plugins/planet4-gpnl-plugin-blocks/includes/assets/js/clang-landing.js?clangct="+a,dataType:"script"}),null!=n&&0!=$(".optin").length&&"in"==n&&($(".optin").hide(),$(".gpnl-petition-checkbox").prop("checked",!0),$("input[name='mail']").keyup(function(){if(/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{3,})$/i.test(this.value)){var e=encodeURIComponent(this.value);$.ajax({type:"GET",url:"https://secure.greenpeacephp.nl/kenikdeze.php?mail="+e,complete:function(e){e.responseText.includes("false")&&($(".optin").show(),$(".gpnl-petition-checkbox").prop("checked",!1))}})}}),o||i||null==url_cg||prefillByGuid("prefill",this));prefillByGuid("teller",{tellerCode:window.election_object.analytics_campaign,type:"total"})}),$(".gpnl-petitionform").on("submit",function(){var t=this,n=getFormObj(t),i="election_object";n.action="petition_form_process",n.nonce=window[i].nonce,n.ad_campaign=window[i].ad_campaign,toggleDisable($(t).find("*")),toggleDisable($(".btn-submit")),$.ajax({type:"POST",url:window[i].ajaxUrl,data:n,success:function(e){console.log("^-^"),"undefined"!=typeof dataLayer&&dataLayer.push({event:"petitiebutton",conv_campaign:form_config.analytics_campaign,conv_action:form_config.ga_action,conv_label:"registreer"}),""!==n.phone?("undefined"!=typeof dataLayer&&dataLayer.push({event:"petitiebutton",conv_campaign:window[form_config].analytics_campaign,conv_action:"telnr",conv_label:"Ja"}),"SB"===window[form_config].ad_campaign?(fbq("track","Lead"),socialBlueDeDuplicate(n.mail,e.data.phone,window[form_config].apref)):"JA"===window[form_config].ad_campaign&&fbq("track",window[form_config].jalt_track)):"undefined"!=typeof dataLayer&&dataLayer.push({event:"petitiebutton",conv_campaign:window[form_config].analytics_campaign,conv_action:"telnr",conv_label:"Nee"}),cardflip(t),console.log(prefillByGuid("teller",window[i])),$("#electionModal").on("hidden.bs.modal",function(){$($(".gpnl-petition-thank")[0]).hide()}),null!=getUrlVars().clangct&&clang.conversion.track()},error:function(){console.log("o_o");var e=$(t.parentNode.nextElementSibling);e.find("*").hide(""),e.append("<p>Sorry, er gaat momenteel iets fout, probeer het nu of later opnieuw.</p>"),e.append("<a href='"+window.location.href+'\' class="btn btn-primary btn-block"">Probeer opnieuw</a>'),cardflip(t)}})});
//# sourceMappingURL=maps/gpnl-election.js.map
