"use strict";function getFormObj(e){var n={},t=$(e).serializeArray();return $.each(t,function(e,t){n[t.name]=t.value}),n}function toggleDisable(e){e.prop("disabled",!e.prop("disabled"))}function cardflip(e){var t=$(e),n=e.parentNode,i=$(e.parentNode.parentNode);$(".btn-submit").toggle(),$(t.find(".policies")).toggle(),$(n.nextElementSibling).css("position",flip_positionattribute(n.nextElementSibling)),$(n).css("position",flip_positionattribute(n)),i.toggleClass("flipped"),i.one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",function(){$(n).toggle(),i.off("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend")})}function flip_positionattribute(e){return"absolute"===$(e).css("position")?"relative":"absolute"}function fireShareEvent(e){if("undefined"!=typeof dataLayer){var t=window.election_object;dataLayer.push({event:"petitiebutton",conv_campaign:t.analytics_campaign,conv_action:"verkiezing",conv_label:"share_"+e})}else console.log("GTM not defined?")}function socialBlueDeDuplicate(e,t,n){var i=("https:"==document.location.protocol?"https://secure.event.":"http://www.")+"affiliatepartners.com",a="/js/ApConversionPixelV1.1.js";_apOrderValue=0,_apOrderNumber="email="+e+"-telefoonnumer="+t,_apRef=n;try{$("body").append(unescape("%3Cscript src='"+i+a+"' type='text/javascript'%3E%3C/script%3E"))}catch(e){var o=document.createElement("script");o.type="text/javascript",o.src=i+a,document.getElementsByTagName("head")[0].appendChild(o)}}function getUrlVars(){for(var e,t=[],n=window.location.href.split("#")[0].slice(window.location.href.indexOf("?")+1).split("&"),i=0;i<n.length;i++)e=n[i].split("="),t.push(e[0]),t[e[0]]=e[1];return t}function showCounter(){for(var e=$("#electionModal"),t=$("#counter_total").data("num"),n=e.data("num"),i=e.find(".counter"),a=i.data("counter"),o=1;o<=n;o++){var l=window["election_object_"+o].count,r=$('[data-counter="'+o+'"]'),s=Math.round(l/t*100);r.show(),r.find(".counter__slider").animate({width:s+"%",opacity:1},2e3,"easeInOutCubic"),r.find(".counter__gettext").html(s+"% van de stemmen"),r.find(".counter__text").fadeIn(2e3),o===a&&(i.show(),i.find(".counter__slider").animate({width:s+"%",opacity:1},2e3,"easeInOutCubic"),i.find(".counter__gettext").html(s+"% van de stemmen"),i.find(".counter__text").fadeIn(2e3))}}function prefillByGuid(a,o){var l=window.election_object,r=new XMLHttpRequest,e="",t="";"prefill"===a?(e="GET_FIRST_NAME_EMAIL",t=o.url_cg):"teller"===a&&(e="CAMP_TTL_PETITIONS",t=o.tellerCode),r.open("POST","https://www.mygreenpeace.nl/GPN.WebServices/WIDSService.asmx",!0);var n='<?xml version="1.0" encoding="utf-8"?><soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">  <soap:Body>    <WatIsDestand xmlns="http://www.mygreenpeace.nl/GPN.WebServices/">      <queryId>'+e+"</queryId>      <requestValue>"+t+"</requestValue>    </WatIsDestand>  </soap:Body></soap:Envelope>";r.onreadystatechange=function(){if(4===r.readyState&&200===r.status){var e=r.responseXML.getElementsByTagName("WatIsDestandResult")[0].firstChild.nodeValue;if(""!==e){var t=e.split("|");if("prefill"===a){var n=t[0];$(o).find("input[name='name']").val(n);var i=t[1];$(o).find("input[name='mail']").val(i)}else"teller"===a&&Number(e)>=l.counter_min&&("total"===o.type?($("#counter_total").data("num",e),$("#counter_total").text(e+" mensen hebben al gestemd.")):o.config.count=e)}}},r.setRequestHeader("Content-Type","text/xml"),r.setRequestHeader("SOAPAction","http://www.mygreenpeace.nl/GPN.WebServices/WatIsDestand"),r.send(n)}$("#electionModal").on("show.bs.modal",function(e){var t=$(e.relatedTarget).data("id"),n=$(this),i=window["election_object_"+t];n.find(".modal-title").text("Stem op "+i.title),n.find(".modal-subtitle").text(i.subtitle),n.find(".modal-body").text(i.description),n.find("input[name='form_id']").val(t),n.find("input[name='marketingcode']").val(i.mcode),n.find(".counter").data("counter",t)}),$(document).ready(function(){var e,t,n;e=".election-options",t=$("#electionModal").data("num"),n=Math.floor(t/2),$(e).slick({infinite:!1,mobileFirst:!0,slidesToShow:1,slidesToScroll:1,arrows:!0,dots:!0,centerMode:!0,centerPadding:"50px",initialSlide:n,responsive:[{breakpoint:992,settings:{slidesToShow:t}},{breakpoint:768,settings:{slidesToShow:3}},{breakpoint:576,settings:{slidesToShow:2}}]});var i=getUrlVars().opt;this.url_cg=getUrlVars().cg;var a=-1!==document.referrer.indexOf("facebook"),o=-1!==document.referrer.indexOf("twitter"),l=getUrlVars().clangct;null!=l&&$.ajax({url:"/wp-content/plugins/planet4-gpnl-plugin-blocks/includes/assets/js/clang-landing.js?clangct="+l,dataType:"script"}),null!=i&&0!=$(".optin").length&&"in"==i&&($(".optin").hide(),$(".gpnl-petition-checkbox").prop("checked",!0),$("input[name='mail']").keyup(function(){if(/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{3,})$/i.test(this.value)){var e=encodeURIComponent(this.value);$.ajax({type:"GET",url:"https://secure.greenpeacephp.nl/kenikdeze.php?mail="+e,complete:function(e){e.responseText.includes("false")&&($(".optin").show(),$(".gpnl-petition-checkbox").prop("checked",!1))}})}}),o||a||null==this.url_cg||prefillByGuid("prefill",this));var r=window.election_object;if(prefillByGuid("teller",{tellerCode:r.analytics_campaign,type:"total"}),!Number(r.hideresults))for(var s=$("#electionModal").data("num"),c=1;c<=s;c++){var d={},p=window["election_object_"+c];d.id=c,d.type="subtotal",d.tellerCode=p.mcode,d.config=p,prefillByGuid("teller",d)}}),$(".gpnl-petitionform").on("submit",function(){var s=this,c=getFormObj(s),d=window.election_object;c.action="petition_form_process",c.nonce=d.nonce,c.ad_campaign=d.ad_campaign,toggleDisable($(s).find("*")),toggleDisable($(".btn-submit")),$.ajax({type:"POST",url:d.ajaxUrl,data:c,success:function(e){console.log("^-^");var t=c.phone,n="on"===c.consent,i=""!==t,a=e.data.phoneresult,o=!1===a||!0===a?a:null,l=e.data.mailresult,r=!1===l||!0===l?l:null;"undefined"!=typeof dataLayer&&(dataLayer.push({event:"RegisterComplete",campaign:d.analytics_campaign,action:"verkiezing",emailKnown:r,telKnown:o,telFilled:i,optin:n}),dataLayer.push({event:"petitiebutton",conv_campaign:d.analytics_campaign,conv_action:"verkiezing",conv_label:"registreer"}),i?dataLayer.push({event:"petitiebutton",conv_campaign:d.analytics_campaign,conv_action:"telnr",conv_label:"Ja"}):dataLayer.push({event:"petitiebutton",conv_campaign:d.analytics_campaign,conv_action:"telnr",conv_label:"Nee"})),cardflip(s),Number(d.hideresults)||showCounter(),$("#electionModal").on("hidden.bs.modal",function(){$($(".gpnl-petition-thank")[0]).hide()}),null!=getUrlVars().clangct&&clang.conversion.track()},error:function(){console.log("o_o");var e=$(s.parentNode.nextElementSibling);e.find("*").hide(""),e.append("<p>Sorry, er gaat momenteel iets fout, probeer het nu of later opnieuw.</p>"),e.append("<a href='"+window.location.href+'\' class="btn btn-primary btn-block"">Probeer opnieuw</a>'),cardflip(s)}})});
//# sourceMappingURL=maps/gpnl-election.js.map
